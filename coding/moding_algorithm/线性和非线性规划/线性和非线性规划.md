# 数学建模规划类问题（线性/非线性单目标规划）

## 知识基础

### 规划问题定义

- 线性规划：在一组线性约束条件的限制下，求一线性目标函数最大或者最小的问题。

> 线性意味着所有变量都是一次方的

- 非线性规划：在一组非线性约束条件（也可以包含线性条件）的限制下，求一线性目标函数最大或者最小的问题。

> “也可以包含线性条件”是指非线性规划的约束条件可以是线性和非线性混合的

### 规划问题关键要素
  
- 决策变量：决策中待决定的自变量

- 目标函数：取决于决策变量的函数

- 约束条件：决策变量应该符合的基本条件

### 规划类优化问题类型

- 连续优化
  - 线性规划问题（$LP$）：目标和约束函数为线性函数
  - 非线性规划（$NLP$）：目标或约束中存在非线性函数
  - 二次规划（$QP$）：目标为二次函数，约束为线性函数
- 离散优化
  - 整数线性规划（$ILP$）：决策变量（部分或全部）为整数的线性规划问题
  - 整数非线性规划（$INLP$）：决策变量（部分或全部）为整数的非线性规划问题
  - $0$-$1$ 规划（$ZOP$）：决策变量为 $0$ 或 $1$ 的规划问题

## MATLAB 单目标线性规划函数模型

### linprog 函数

#### 函数模型

```m
[tar_x, tar_value] = linprog(tar_fun, ineq_coeff_mat, ineq_const_mat, eq_coeff_mat, eq_const_mat ,min_x, max_x);
```

参数解释

- `tar_fun` 表示目标函数
  
- `ineq_coeff_mat` 表示不等式约束条件系数矩阵
  
- `ineq_const_mat` 表示不等式约束条件常数矩阵
  
- `eq_coeff_mat` 表示等式约束条件系数矩阵
  
- `eq_const_mat` 表示等式约束条件常数矩阵

- `min_x` 表示决策变量的下限数组

- `max_x`表示决策变量的上限数组

> 由于 `tar_fun` 是线性函数，那么直接代入它的系数数组即可（按顺序对应变量）
>
> 对于不存在的约束，在 `MATLAB` 中可以直接用空矩阵 `[]` 代替

返回值解释

- `tar_x` 表示目标函数 `tar_fun` 取得最小值时的决策变量取值数组

- `tar_value` 表示目标函数 `tar_fun` 取得的最小值

> 对于要求最大值的情形，取相反数作为目标函数代入即可

#### 使用示例

设有线性规划问题如下：

不等式约束条件为：
$$
x_1+x_2\le2\\
x_1+\frac{x_2}{4}\le1\\
x_1-x_2\le2\\
-\frac{x_1}{4}-x_2\le1\\
-x_1-x_2\le-1\\
-x_1+x_2\le2
$$

等式约束条件为：
$$
x_1 + \frac{x_2}{4} = \frac{1}{2}\\
$$

决策变量上下界为：
$$
-1\le x_1\le1.5\\
-0.5\le x_2\le1.25
$$

目标函数是：

$$
-x_1-\frac{x_2}{3}
$$

将不等式和等式约束条件写成矩阵的形式：

$$
\begin{pmatrix}
1&1\\
1&\frac{1}{4}\\
1&-1\\
-\frac{1}{4}&-1\\
-1&-1\\
-1&1
\end{pmatrix}
\begin{pmatrix}
x_1\\
x_2   
\end{pmatrix}
\le
\begin{pmatrix}
2\\
1\\
2\\
1\\
-1\\
2    
\end{pmatrix}
$$

$$
\begin{pmatrix}
1&\frac{1}{4}
\end{pmatrix}
\begin{pmatrix}
x_1\\
x_2    
\end{pmatrix}
=
\frac{1}{2}
$$

调用函数解决：

```m
tar_fun = [-1 -1/3]; % 目标函数
ineq_coeff_mat = [1 1 ; 1 1/4 ; 1 -1 ; -1/4 -1 ; -1 -1 ; -1 1 ];
ineq_const_mat = [2 ; 1 ; 2 ; 1 ; -1 ; 2];
eq_coeff_mat = [1 1/4];
eq_const_mat = [1/2];
min_x = [-1 -0.5];
max_x = [1.5 1.25];

[tar_x, tar_value] = linprog(tar_fun, ineq_coeff_mat, ineq_const_mat, eq_coeff_mat, eq_const_mat ,min_x, max_x);
```

如果成功调用并且结果正确，会在命令行区显示：

```
>>> [tar_x, tar_value] = linprog(tar_fun, ineq_coeff_mat, ineq_const_mat, eq_coeff_mat, eq_const_mat ,min_x, max_x);

Optimal solution found.
```

### intlinplog 函数

`intlinplog` 函数主要用于处理整数线性规划问题。

和 `linplog` 使用方法基本一致，唯一的不同是：`intlinplog` 函数在参数列表的第一个参数后插入了一个类型为数组的参数：`intcon`，这个参数数组的涵义是指明决策变量数组中的第几个变量为整数变量

比如 `intcon = [1, 5]` 表示决策变量中 $x_1$ 和 $x_5$ 是整数变量

假设上面的例子中第二个变量即 $x_2$ 是整数变量，那么调用函数应该这样修改：

```m
intcon = [2];
[tar_x, tar_value] = intlinprog(tar_fun, intcon, ineq_coeff_mat, ineq_const_mat, eq_coeff_mat, eq_const_mat ,min_x, max_x);
```

调用这个函数会给出以下提醒：

```
>> [tar_x, tar_value] = intlinprog(tar_fun, intcon, ineq_coeff_mat, ineq_const_mat, eq_coeff_mat, eq_const_mat ,min_x, max_x);

LP:                Optimal objective value is -0.583333.                                            


Optimal solution found.

Intlinprog stopped at the root node because the objective value is within a gap tolerance of the
optimal value, options.AbsoluteGapTolerance = 0 (the default value). The intcon variables are
integer within tolerance, options.IntegerTolerance = 1e-05 (the default value).
```

请不要惊慌——这不是报错，它表示：这个解法得到的结果可能实际上不一定是一个整数，但是它已经尽可能地进行精确，并且当前的误差为 `1e-05` 即 $0.00001$（你也可以将这个误差允许值设置得更小），它已经在这个误差内得到了结果。

## LINGO 单目标非线性规划

### 为什么是 LINGO

`LINGO` 是一款专门用于解决规划类问题的软件。在处理线性规划问题上，和 `MATLAB` 相比，`LINGO` 更具有优势：

- 可以支持二维决策变量
- 求解 `NLP` 问题时不需要进行初值估计
- 使用集合命令，更加直观，方便描述复杂条件
- 不需要人为指定算法，减少了理解算法的过程

### LINGO 入门

请移步 `LINGO` 入门教程 

### 使用指南

##





